<html>
<head>
<meta charset="utf-8" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="msapplication-tap-highlight" content="no" />
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width" />
    <meta http-equiv="Content-Security-Policy" content="default-src * 'unsafe-inline'; style-src 'self' 'unsafe-inline'; media-src *" />
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css">
<style>
      #map {
        height: 100%;
      }
    </style>
<script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
<script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
<link type="text/css" rel="stylesheet" href="css/examples.css" />
<link type="text/css" rel="stylesheet" href="css/mmenu.css" />
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="js/jquery.mmenu.js"></script>
<script type="text/javascript">
            $(function() {
                $('nav#menu').mmenu();
            });
        </script>
</head>
<body>

<div id="page">
<div id="header"> <a href="#menu"></a> Test CityTaxi </div>
<div id="content">
<h4 id="address">Cargando...</h4>
<div id="map"></div>
</div>
<nav id="menu">
<ul>
<li><a href="#map">Posici√≥n</a></li>
<li><a href="">Acerca de</a></li>
</ul>
</nav>
</div>


    <script>

    var geocode="http://maps.googleapis.com/maps/api/geocode/json?latlng=";

function initMap() {
  var map = new google.maps.Map(document.getElementById('map'), {
    center: {lat: 5.064084, lng: -75.511013},
    zoom: 14
  });
  var marker=new google.maps.Marker({map: map});
  map.addListener('click', function(event) {
    //map.setZoom(8);
    //map.setCenter(marker.getPosition());
    marker.setPosition(event.latLng);
    geocoder(event.latLng.lat(), event.latLng.lng())
  });

  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(function(position) {
      var pos = {
        lat: position.coords.latitude,
        lng: position.coords.longitude
      };
      geocoder(position.coords.latitude, position.coords.longitude)
      map.setCenter(pos);
    }, function() {
      handleLocationError(true, map.getCenter(), marker);
    });
  } else {
    console.log("el navegador no soporta la geolocalizacion")
    handleLocationError(false, map.getCenter(), marker);
  }
}

function handleLocationError(browserHasGeolocation, pos, marker) {
  marker.setPosition(pos);
  var marker=new google.maps.Marker({
    position:myLatlng,
  });

marker.setMap(map);
  geocoder(5.064084,-75.511013)
}

function geocoder(lat, lng){
   $.get( geocode+""+lat+","+lng, function( data ) {
    var address=data.results[0].formatted_address;
    $("#address").html(address)
});
}

    </script>

<script type="text/javascript" src="cordova.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?callback=initMap"
        async defer></script>
    <script type="text/javascript">
        app.initialize();
    </script>

</body>
</html>
